<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/D_32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/D_16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>

  <meta name="description" content="简介感觉是一个很有未来的东西">
<meta property="og:type" content="article">
<meta property="og:title" content="生成函数">
<meta property="og:url" content="http://example.com/2021/07/26/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/index.html">
<meta property="og:site_name" content="DDOSvoid&#39;s Blog">
<meta property="og:description" content="简介感觉是一个很有未来的东西">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-07-26T11:12:25.000Z">
<meta property="article:modified_time" content="2022-04-20T13:01:46.585Z">
<meta property="article:author" content="DDOSvoid">
<meta property="article:tag" content="Tech">
<meta property="article:tag" content="生成函数">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2021/07/26/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>生成函数 | DDOSvoid's Blog</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">DDOSvoid's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%99%AE%E9%80%9A%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0"><span class="nav-number">2.</span> <span class="nav-text">普通生成函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89"><span class="nav-number">2.1.</span> <span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%81%E9%97%AD%E5%BD%A2%E5%BC%8F%E4%B8%8E%E5%B1%95%E5%BC%80%E5%BD%A2%E5%BC%8F"><span class="nav-number">2.2.</span> <span class="nav-text">封闭形式与展开形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%A0%E4%B8%AA%E9%87%8D%E8%A6%81%E7%9A%84%E5%B0%81%E9%97%AD%E5%BD%A2%E5%BC%8F%E4%B8%8E%E5%B1%95%E5%BC%80%E5%BD%A2%E5%BC%8F"><span class="nav-number">2.3.</span> <span class="nav-text">几个重要的封闭形式与展开形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E6%84%8F%E4%B9%89"><span class="nav-number">2.4.</span> <span class="nav-text">组合意义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AE%E7%A7%AF%E5%88%86"><span class="nav-number">2.5.</span> <span class="nav-text">微积分</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E6%95%B0%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0"><span class="nav-number">3.</span> <span class="nav-text">指数生成函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-1"><span class="nav-number">3.1.</span> <span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%A0%E4%B8%AA%E9%87%8D%E8%A6%81%E7%9A%84%E5%B0%81%E9%97%AD%E5%BD%A2%E5%BC%8F%E5%92%8C%E5%B1%95%E5%BC%80%E5%BD%A2%E5%BC%8F"><span class="nav-number">3.2.</span> <span class="nav-text">几个重要的封闭形式和展开形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E6%84%8F%E4%B9%89-1"><span class="nav-number">3.3.</span> <span class="nav-text">组合意义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AE%E7%A7%AF%E5%88%86-1"><span class="nav-number">3.4.</span> <span class="nav-text">微积分</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E7%8E%87%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0"><span class="nav-number">4.</span> <span class="nav-text">概率生成函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-2"><span class="nav-number">4.1.</span> <span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E5%8F%96%E5%80%BC"><span class="nav-number">4.2.</span> <span class="nav-text">特殊取值</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E6%95%B0%E5%85%AC%E5%BC%8F%E5%AE%9A%E7%90%86%EF%BC%88%E6%8C%87%E6%95%B0%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0exp%E7%9A%84%E7%BB%84%E5%90%88%E6%84%8F%E4%B9%89%EF%BC%89"><span class="nav-number">5.</span> <span class="nav-text">指数公式定理（指数生成函数exp的组合意义）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Euler%E5%8F%98%E6%8D%A2"><span class="nav-number">6.</span> <span class="nav-text">Euler变换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E5%AF%B9%E5%BA%8F%E5%88%97%E9%AB%98%E9%98%B6%E5%B7%AE%E5%88%86%E5%92%8C%E9%AB%98%E9%98%B6%E5%89%8D%E7%BC%80%E5%92%8C%E7%9A%84%E4%BC%98%E5%8C%96"><span class="nav-number">7.</span> <span class="nav-text">生成函数对序列高阶差分和高阶前缀和的优化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%95%B0%E5%88%97%E7%9A%84%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E6%8E%A8%E5%AF%BC"><span class="nav-number">8.</span> <span class="nav-text">常见数列的生成函数推导</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0"><span class="nav-number">8.1.</span> <span class="nav-text">斐波那契数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0"><span class="nav-number">8.2.</span> <span class="nav-text">卡特兰数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E7%B1%BB%E9%80%9A%E8%BF%87%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E6%B1%82%E7%BA%BF%E6%80%A7%E9%80%92%E6%8E%A8%E5%BC%8F%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">9.</span> <span class="nav-text">一类通过生成函数求线性递推式的方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98"><span class="nav-number">10.</span> <span class="nav-text">例题</span></a></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DDOSvoid"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">DDOSvoid</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">700</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">132</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/DDOSvoid" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;DDOSvoid" rel="noopener" target="_blank">GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.luogu.com.cn/user/34531" title="Luogu → https:&#x2F;&#x2F;www.luogu.com.cn&#x2F;user&#x2F;34531" rel="noopener" target="_blank">Luogu</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://codeforces.com/profile/DDOSvoid" title="Codeforces → http:&#x2F;&#x2F;codeforces.com&#x2F;profile&#x2F;DDOSvoid" rel="noopener" target="_blank">Codeforces</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://acm.hdu.edu.cn/userstatus.php?user=DDOSvoid" title="Hdu → http:&#x2F;&#x2F;acm.hdu.edu.cn&#x2F;userstatus.php?user&#x3D;DDOSvoid" rel="noopener" target="_blank">Hdu</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fas fa-link fa-fw"></i>
      友链
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/manziqi/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;manziqi&#x2F;" rel="noopener" target="_blank">Title1</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://jczhang.top/" title="https:&#x2F;&#x2F;jczhang.top&#x2F;" rel="noopener" target="_blank">JC Blog</a>
        </li>
    </ul>
  </div>

      </section>
        <div class="back-to-top animated">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">
      

      

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/07/26/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="DDOSvoid">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DDOSvoid's Blog">
    </span>

    
    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          生成函数
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-07-26 19:12:25" itemprop="dateCreated datePublished" datetime="2021-07-26T19:12:25+08:00">2021-07-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-04-20 21:01:46" itemprop="dateModified" datetime="2022-04-20T21:01:46+08:00">2022-04-20</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OI-ACM/" itemprop="url" rel="index"><span itemprop="name">OI & ACM</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>11k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>10 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>感觉是一个很有未来的东西</p>
<a id="more"></a>
<h2 id="普通生成函数"><a href="#普通生成函数" class="headerlink" title="普通生成函数"></a>普通生成函数</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>序列 $a_1,a_2,\cdots a_n$ 的普通生成函数，又称 $OGF$，定义为形式幂级数 $F(x)=\sum_{i=0}^{\infty} a_ix^i$</p>
<p>通过将 $a_{n+1}\cdots$ 等设置为 $0$，将其变成一个有限数列</p>
<p>注意到我们一直将生成函数称为形式幂级数，即我们只考虑它的形式</p>
<h3 id="封闭形式与展开形式"><a href="#封闭形式与展开形式" class="headerlink" title="封闭形式与展开形式"></a>封闭形式与展开形式</h3><p>对于生成函数 $F(x)=1+x+x^2+\cdots$，容易得到 $xF(x)+1=F(x)$，所以 $F(x)=\frac{1}{1-x}$</p>
<p>而 $F(x)=\frac{1}{1-x}$ 就是 $F(x)=1+x+x^2+\cdots$​ 的封闭形式，反过来 $F(x)=1+x+x^2+\cdots$ 是展开形式</p>
<h3 id="几个重要的封闭形式与展开形式"><a href="#几个重要的封闭形式与展开形式" class="headerlink" title="几个重要的封闭形式与展开形式"></a>几个重要的封闭形式与展开形式</h3><p>$1+x+x^2+\cdots=\frac{1}{1-x}$ </p>
<p>$1+x^k+x^{2k},\cdots=\frac{1}{1-x^k}$</p>
<p>$1+ax+a^2x^2+\cdots=\frac{1}{1-ax}$​</p>
<p>$x^k+x^{k+1}+\cdots =\frac{x^k}{1-x}$</p>
<p>$\sum_{n=0}^{\infty} \binom{n+k-1}{k-1}x^n=\frac{1}{(1-x)^k}$​</p>
<h3 id="组合意义"><a href="#组合意义" class="headerlink" title="组合意义"></a>组合意义</h3><p>普通生成函数解决的是若干种物品的组合问题</p>
<h3 id="微积分"><a href="#微积分" class="headerlink" title="微积分"></a>微积分</h3><p>$\frac{\rm d}{\rm dx}(\sum_{n=0}^{\infty}a_nx^n)=\sum_{n=0}^\infty(n+1)a_{n+1}x^n$</p>
<p>$\int(\sum_{n=0}^\infty a_nx^n)=\sum_{n=1}^\infty\frac{f_{n-1}}{n}x^n+C$</p>
<h2 id="指数生成函数"><a href="#指数生成函数" class="headerlink" title="指数生成函数"></a>指数生成函数</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p>序列 $a_1,a_2,\cdots a_n$ 的指数生成函数，又称 $EGF$，定义为形式幂级数 $F(x)=\sum_{i=0}^{\infty} \frac{a_i}{i!}x^i$​</p>
<h3 id="几个重要的封闭形式和展开形式"><a href="#几个重要的封闭形式和展开形式" class="headerlink" title="几个重要的封闭形式和展开形式"></a>几个重要的封闭形式和展开形式</h3><p>$1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+\cdots=e^x$</p>
<p>$1-x+\frac{x^2}{2!}-\frac{x^3}{3!}+\cdots=e^{-x}$</p>
<p>$1+\frac{x^2}{2!}+\frac{x^4}{4!}+\frac{x^6}{6!}+\cdots=\frac{e^x+e^{-x}}{2}$</p>
<p>$x+\frac{x^3}{3!}+\frac{x^5}{5!}+\frac{x^7}{7!}=\frac{e^x-e^{-x}}{2}$</p>
<p>$\sum_{n=1}^{\infty}\frac{(-1)^{n-1}}{n}x^n=\ln(1+x)$</p>
<p>$\sum_{n=1}^{\infty}\frac{1}{n}x^n=\ln(\frac{1}{1-x})$</p>
<p>$\sum_{n=0}^\infty(-1)^n\frac{x^{2n+1}}{(2n+1)!}=\sin x$</p>
<p>$\sum_{n=0}^\infin \frac{x^{2n}}{(2n)!}=\cos x$</p>
<h3 id="组合意义-1"><a href="#组合意义-1" class="headerlink" title="组合意义"></a>组合意义</h3><p>指数生成函数解决的是若干种物品的排列问题</p>
<h3 id="微积分-1"><a href="#微积分-1" class="headerlink" title="微积分"></a>微积分</h3><p>$\frac{\rm d}{\rm dx}(\sum_{n=0}^{\infty}a_n\frac{x^n}{n!})=\sum_{n=0}^\infty a_{n+1}\frac{x^n}{n!}$</p>
<p>$\int(\sum_{n=0}^\infty a_n\frac{x^n}{n!})=\sum_{n=1}^\infty a_{n-1}\frac{x^n}{n!}+C$</p>
<p>注意到指数生成函数的求导和积分相当于是左移和右移，而乘 $x$ 和除 $x$ 则是类似普通生成函数积分和求导一样的东西</p>
<h2 id="概率生成函数"><a href="#概率生成函数" class="headerlink" title="概率生成函数"></a>概率生成函数</h2><h3 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h3><p>若 $X$ 为某个离散型随机变量，那么 $X$ 的概率生成函数为</p>
<script type="math/tex; mode=display">
F(x)=\sum_{i=0}^\infty \Pr(X=i)x^i</script><h3 id="特殊取值"><a href="#特殊取值" class="headerlink" title="特殊取值"></a>特殊取值</h3><ul>
<li>$F(1)=1$</li>
<li>$E(X)=F’(X)$</li>
<li>$E^2(X)=F’’(X)+F’(X)$</li>
<li>$V(X)=F’’(X)+F’(X)-F’(X)^2$</li>
</ul>
<h2 id="指数公式定理（指数生成函数exp的组合意义）"><a href="#指数公式定理（指数生成函数exp的组合意义）" class="headerlink" title="指数公式定理（指数生成函数exp的组合意义）"></a>指数公式定理（指数生成函数exp的组合意义）</h2><p>如果存在两个 $EGF$，$F(x)$ 与 $G(x)$，满足 $e^{F(x)}=G(x)$，$F(x)$ 是 $f$ 的 $EGF$，那么 $G(x)$ 是 </p>
<script type="math/tex; mode=display">
g_n=\sum_{\pi=\lbrace S_1,S_2,\cdots,S_k\rbrace}\prod_{i=1}^kf_{|S_i|}</script><p>的 $EGF$​​，其中 $\pi$ 是 $[n]$ 的划分</p>
<p>来源：<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/220037/exp-formula#">https://www.luogu.com.cn/blog/220037/exp-formula#</a></p>
<p>上面那个解释不是太好理解，我们思考下面这个解释</p>
<p>把 $n$ 个有标号的球放到任意多个无标号盒子中，并且一个放了 $i$ 个球的盒子有 $a_i$ 种染色方案，那么放 $n$ 个球并染色的方案就是 $[x^n]exp(A(x))$</p>
<p>我们来看一个最经典的式子，贝尔数 $B(x)=exp(e^x-1)$，贝尔数的定义：将 $n$ 个有标号的小球放到任意多个无标号盒子中的方案数，注意到将大于等于 $1$ 个球放到一个盒子中的方案都是 $1$，所以 $A(x)=e^x-1$，那么 $B(x)=exp(A(x))$</p>
<ol>
<li><p>令 $F (x)$ 为带标号简单无向连通图的指数生成函数，$G( x)$ 为带标号无向图的指数生成函数</p>
<p>我们有 $e^{F(x)}=G(x)$，$g_n=2^{\binom{n}{2}}$</p>
</li>
</ol>
<h2 id="Euler变换"><a href="#Euler变换" class="headerlink" title="Euler变换"></a>Euler变换</h2><p>将 $exp$ 的组合意义中的有标号元素换成无标号元素就得到了 $Euler$ 变换，$euler(F(x))=\prod_{n} \frac{1}{(1-x^n)^{f_n}}$</p>
<h2 id="生成函数对序列高阶差分和高阶前缀和的优化"><a href="#生成函数对序列高阶差分和高阶前缀和的优化" class="headerlink" title="生成函数对序列高阶差分和高阶前缀和的优化"></a>生成函数对序列高阶差分和高阶前缀和的优化</h2><p>首先我们考察前缀和，令 $A_0(x)$ 为原序列 $a_i$ 的生成函数，那么一阶前缀和 $A_1(x)=\sum_{n=0}\sum_{i=0}^na_ix^n=\sum_{n=0}x^n\sum_{i=0}^na_ib_{n-i}$，其中 $b_n=1$，能够发现这是一个卷积的形式，那么 $A_1(x)=A_0(x)B(x)$，能够发现 $B(x)$ 就是 $\frac{1}{1-x}$</p>
<p>差分和前缀和类似，能够得到一阶差分就是乘上 $1-x$</p>
<p>综上，$A_k(x)=(1-x)^{-k}A(x)$，$k&gt;0$ 为 $k$ 阶前缀和，$k&lt;0$ 为 $k$ 阶差分 </p>
<p>当我们需要求 $k$ 阶前缀和或者 $k$ 阶差分时，直接使用 $(1-x)^{-k}$ 的展开式即可</p>
<h2 id="常见数列的生成函数推导"><a href="#常见数列的生成函数推导" class="headerlink" title="常见数列的生成函数推导"></a>常见数列的生成函数推导</h2><h3 id="斐波那契数"><a href="#斐波那契数" class="headerlink" title="斐波那契数"></a>斐波那契数</h3><p>众所周知，斐波那契数列的递推是 $f_0=0,f_1=1,f_n=f_{n-1}+f_{n-2}$，那么我们容易得到 $f_n$ 的生成函数 $F(x)$ 的递推式为 $F(x)=x+xF(x)+x^2F(x)$，即 $F(x)=\frac{x}{1-x-x^2}$，通过这个东西可以退出斐波那契数的通项公式为 $f_n=\frac{(\frac{1+\sqrt 5}{2})^n-(\frac{1-\sqrt 5}{2})^n}{\sqrt 5}$</p>
<h3 id="卡特兰数"><a href="#卡特兰数" class="headerlink" title="卡特兰数"></a>卡特兰数</h3><p>众所周知，卡特兰数的递推是 $f_0=1,f_n=\sum_{i=0}^{n-1}f_if_{n-1-i}$，那么我们容易得到 $f_n$ 的生成函数 $F(x)$ 的递推式为 $F(x)=1+xF(x)^2$，即 $F(x)=\frac{1-\sqrt {1-4x}}{2x}$</p>
<h2 id="一类通过生成函数求线性递推式的方法"><a href="#一类通过生成函数求线性递推式的方法" class="headerlink" title="一类通过生成函数求线性递推式的方法"></a>一类通过生成函数求线性递推式的方法</h2><p>这里我们只考虑求 $F(x)=\sqrt {G(x)}$ 的公式，令 $H(x)=\frac{1}{\sqrt {G(x)}}$</p>
<p>$F’(x)=\frac{G’(x)}{2\sqrt{G(x)}}=\frac{G’(x)}{2}H(x)$</p>
<p>$H’(x)=-\frac{G’(x)}{2G(x)}H(x)$</p>
<p>则有 $G’(x)H(x)=-2H’(x)G(x)$</p>
<p>另外我们有 $2F’(x)=G’(x)H(x)$</p>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><ol>
<li><p>简要题意：给定 $n$ 和 $[1,n]$ 中生成每个数的概率 $p_i$，现在开始随机生成 $[1,n]$ 的数，若生成的数不是已经生成的数的最大值，那么停止生成，最终得分是生成的数的个数的平方，求期望得分</p>
<p>$n\le 100$</p>
<p>简要题解：我们考虑概率生成函数 $F(x)=\sum_{i=0}^{\infty}\Pr(X\ge i)x^i$​，随机变量 $X$ 表示生成的数的个数</p>
<p>那么我们发现 $F(x)=\prod_{i=1}^n\frac{1}{1-p_ix}$​，原因的话，我们考虑枚举所有生成了 $k$​ 个数的情况，因为这 $k$​ 个数的生成只有一种顺序，所以可以看成集合</p>
<p>考虑将我们要求的东西转换成与 $F(x)$ 有关的式子：</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{i=0}^{\infty}i^2\Pr(X=i)x^i&=\sum_{i=0}^{\infty}i^2(\Pr(X\ge i)-\Pr(X\ge i+1))x^i\\
&=\sum_{i=0}^\infty i^2\Pr(X\ge i)x^i-\sum_{i=0}^\infty i^2\Pr(X\ge i+1)x^i\\
&=\sum_{i=0}^\infty(2i+1)\Pr(X\ge i)x^i\\
&=2F'(x)+F(x)
\end{aligned}</script><p>那么答案就是 $2F’(1)+F(1)$，容易得到 $F’(x)=F(x)\sum_{i=1}^n\frac{p_i}{1-p_ix}$，时间复杂度 $O(n)$</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2021/07/26/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A14-B-Sample-Game/">2021牛客多校4 B Sample Game</a> </p>
</li>
<li><p>简要题意：给定 $n,k,D$，对于一个长度为 $n$ 的序列 $a_i$，我们定义它的价值为 $\frac{D!}{\prod_{i=1}^n(a_i+k)!}$，求对于所有满足 $\sum_{i=1}^n a_i=D,a_i\ge 0$ 的序列 $a_i$ 的价值和</p>
<p>$n,k\le 50,D\le 10^8$</p>
<p>简要题解：我们考虑转换一下原式，得到 $\frac{(D+nk)!}{\prod_{i=1}^n(a_i+k)!}\times \frac{D!}{(D+nk)!}$​，其中 $\sum_{i=1}^n a_i=D,0\le a_i\le D$</p>
<p>容易得到这个式子的前半部分等价于 $EGF$，$<a href="e^x-\sum_{i=0}^{k-1}\frac{x^i}{i!}">x^{D+nk}</a>^n$</p>
<p>它的组合意义很明显，有 $n$ 种物品，每种物品有 $D+k$ 个，且至少选 $k$ 个，一共选 $D+nk$ 个物品做排列的方案数</p>
<p>然后对于这个东西，我们直接暴力二项式展开算系数即可，时间复杂度 $O(D+n^2k)$</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2021/07/26/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A14-G-Product/">2021牛客多校4 G Product</a></p>
</li>
<li><p>简要题意：你现在有一个整数 $x$，题目给出它属于 $[0,n]$ 中某个数的概率，现在要进行 $m$ 次随机，每次随机将等概率的将 $x$ 变成 $[0,x]$ 中的任意一个整数，求 $m$ 次操作后，整数 $x=k$，其中 $k\in[0,n]$ 的概率</p>
<p>$n\le 10^5,m\le 10^{18}$</p>
<p>简要题解：我们令 $f_{k,i}$ 表示进行了 $k$ 次随机之后为 $i$ 的概率，容易得到 $f_{k,i}=\sum_{j=i}^n\frac{f_{k-1,j}}{j+1}$，发现这个东西是一个线性变换，尝试用生成函数搞一下，我们将其写成生成函数的形式，得到 $F_{k}(x)=\sum_{i=0}^nf_{k,i}x^i$，然后尝试化简一下</p>
<script type="math/tex; mode=display">
\begin{aligned}
F_k(x)&=\sum_{i=0}^nf_{k,i}x^i\\
&=\sum_{i=0}^nx^i\sum_{j=i}^n\frac{f_{k-1,j}}{j+1}\\
&=\sum_{j=0}^n\frac{f_{k-1,j}}{j+1}\sum_{i=0}^jx^i\\
&=\sum_{j=0}^n\frac{f_{k-1,j}}{j+1}\frac{x^{j+1}-1}{x-1}\\
&=\frac{1}{x-1}\sum_{j=0}^nf_{k-1,j}\frac{x^{j+1}-1}{j+1}\\
&=\frac{1}{x-1}\sum_{i=0}^nf_{k-1,i}\int_{1}^xt^i\rm dt\\
&=\frac{1}{x-1}\int_{1}^x(\sum_{i=0}f_{k-1,i}t^i)\rm dt\\
&=\frac{1}{x-1}\int_1^xF_{k-1}(t)\rm dt
\end{aligned}</script><p>现在似乎有点眉目了，但是这个 $\frac{1}{x-1}$ 和这个从 $1$ 积到 $x$ 的积分不是很好应对，我们令 $G_{k}(x)=F_{k}(x+1)$，然后在带进这个式子里去，$G_{k}(x)=\frac{1}{x}\int_{1}^{x+1}F_{k-1}(t)\rm dt=\frac{1}{x}\int_{0}^xF_{k-1}(t+1)\rm dt$，我们注意到 $G_{k-1}(x)=F_{k-1}(x+1)$，那么我们就能得到 $G_k(x)=\frac{1}{x}\int_{0}^xG_{k-1}(x)\rm dt=\sum_{i=0}^n\frac{1}{i+1}g_{k-1,i}x^i$，也就是说 $g_{k,i}=\frac{1}{(i+1)^k}g_{0,i}$，然后我们只需要求一下 $F_0(x)$ 到 $G_0(x)$ 的转换和 $G_m(x)$ 到 $F_m(x)$ 的转换，推一下能发现都是一个差卷积的形式，时间复杂度 $O(n\log n)$</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2021/11/23/VK-Cup-2018-Round-1-E-Perpetual-Subtraction/">VK Cup 2018 - Round 1 E Perpetual Subtraction</a></p>
</li>
<li><p>简要题意：现在有 $n$ 种物品，每种物品都有无限多个，第 $i$ 个物品的体积为 $v_i$，求恰好装满 $k,k\in[1,m]$ 的背包的方案数</p>
<p>$n,m\le 10^5$ </p>
<p>简要题解：容易得到生成函数 $F(x)=\prod_{i=1}^n\frac{1}{1-x^{v_i}}$，我们尝试用 $\exp$ 和 $\ln$ 来操作一下，$F(x)=exp(\ln F(x))=exp(\sum_{i=1}^n\ln\frac{1}{1-x^{v_i}})$，我们知道 $\ln(\frac{1}{1-x})=\sum_{i\ge 1}\frac{x^i}{i}$，那么 $\sum_{i=1}^n\ln\frac{1}{1-x^{v_i}}$，我们是可以在 $O(n\log n)$ 的时间内完成预处理的，这样再做一个 $exp$ 就结束了，时间复杂度 $O(n\log n)$</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2021/11/23/Luogu-P4389-%E4%BB%98%E5%85%AC%E4%B8%BB%E7%9A%84%E8%83%8C%E5%8C%85/">Luogu P4389 付公主的背包</a></p>
</li>
<li><p>简要题意：令 $f_n$ 为斐波那契数第 $n$ 项，求 $\sum \prod_{i=1}^m f_{a_i}$，$m&gt;0,a_1,a_2,\cdots,a_m&gt;0,\sum_{i=1}^ma_i=n$</p>
<p>$n\le 10^{100000}$</p>
<p>简要题解：令 $F(x)$ 为斐波那契数的生成函数，那么容易得到答案的生成函数就是 $\sum_{i=0}^\infty F(x)^i-[n=0]=\frac{1}{1-F(x)}-[n=0]$</p>
<p>我们考虑 $G(x)=\frac{1}{1-F(x)}$ 这个生成函数，我们知道 $F(x)=\frac{x}{1-x-x^2}$，那么 $G(x)=\frac{1-x-x^2}{1-2x-x^2}$，我们尝试求出它的递推式</p>
<p>我们知道分母的递推式就是 $a_n=2a_{n-1}+a_{n-2}$，我们将这个递推式乘上 $1-x-x^2$，那么变成 $a_n-a_{n-1}-a_{n-2}=a_{n-1}\rightarrow a_n=2a_{n-1}+a_{n-2}$，解特征方程能得到 $x_1=1-\sqrt 2,x_2=1+\sqrt 2$，我们知道 $a_0=0,a_1=1$，能够得到 $a_n=\frac{(1+\sqrt 2)^n-(1-\sqrt 2)^n}{2\sqrt 2}$</p>
<p>我们知道 $2$ 在 $1e9+7$ 下有二次剩余 $59713600$，那么我们直接做快速幂即可，注意指数要对 $\varphi(1e9+7)$ 取模</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2021/11/25/Luogu-P4451-%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F-%E6%95%B4%E6%95%B0%E7%9A%84lqp%E6%8B%86%E5%88%86/">Luogu P4451 [国家集训队]整数的lqp拆分</a></p>
</li>
<li><p>简要题意：给定一个含有 $n$ 个相异正整数的序列 $c_i$，现在要求用这些数构造一个带点权的有根无标号二叉树（形态不同，二叉树不同），一棵二叉树的权值为所有点的权值的和，现在给定 $m$，求权值为 $m$ 的二叉树的个数</p>
<p>$n,m\le 10^5$</p>
<p>简要题解：我们考虑 $dp$，令 $f_k$ 表示权值为 $k$ 的二叉树的个数，$f_k=\sum_{c\in S}\sum_{i=0}^{k-c}f_{i}f_{k-c-i}$，其中 $f_0=1$，那么容易得到生成函数为 $F(x)=C(x)F(x)^2+1$，解得 $F(x)=\frac{1-\sqrt {1-4C(x)}}{2C(x)}$，我们上下同乘 $1+\sqrt {1-4C(x)}$，得到 $\frac{2}{1+\sqrt {1-4C(x)}}$，那么现在我们只需要多项式开根和多项式求逆即可，时间复杂度 $O(n\log n)$</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2021/11/26/CF-438E-The-Child-and-Binary-Tree/">CF 438E The Child and Binary Tree</a></p>
</li>
<li><p>简要题意：现在有 $n$ 个骨牌，每个骨牌有左右两边，每边只能是黑色和白色且不能交换，现在给定 $n$ 个骨牌，有些骨牌的的某一些边已经固定了颜色，剩下的位置需要你来染色，现在一种合法的染色方案为将 $n$ 个骨牌染好色之后，存在一个圆排列满足，任亮两个相邻骨牌的相邻的两个边的颜色不同，即第 $i$ 个骨牌的右边和第 $i+1$ 个骨牌的左边的颜色不同，求有多少种染色方案</p>
<p>$n\le 10^5$</p>
<p>简要题解：容易得到一个合法方案一定有 $00$ 和 $11$ 的数量相同，但如果 $00$ 和 $11$ 都只出现一次，会有一些不合法方案，这个单独处理即可，所以接下来的讨论我们不考虑这种情况</p>
<p>我们令 $a$ 表示 $00$ 的个数，$b$ 表示 $11$ 的个数，$c$ 表示 $0?$ 加上 $?0$ 个数，$d$ 表示 $1?$ 加上 $?1$ 的个数，$e$ 表示 $??$ 个数</p>
<p>令 $f_{i}$ 表示 $00$ 的个数减掉 $11$ 的个数为 $i$ 的染色方案数</p>
<p>容易得到一个 $c$ 会让 $f’_i= f_i+f_{i-1}$，一个 $d$ 会让 $f’_i=f_i+f_{i+1}$，一个 $e$ 会让 $f’_i=f_{i-1}+2f_i+f_{i+1}$，这个东西是线性变换，我们考虑多项式，第一个相当于乘上 $(1+x)^c$，第二个相当于乘上 $(1+\frac{1}{x})^d$，第三个相当于乘上 $(2+x+\frac{1}{x})$，除了第三个，前面两个的式子我们都可以手推出来，第三个我们只能做多项式快速幂了</p>
<p>时间复杂度为 $O(n\log n)$，但常数巨大</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2021/12/12/CF-1608D-Dominoes-%E5%A4%9A%E9%A1%B9%E5%BC%8F/">CF 1608D Dominoes(多项式)</a></p>
</li>
<li><p>简要题意：求 $n$ 个点的无标号无根树数量，答案对 $998244353$ 取模</p>
<p>$n \le 2\times 10^5$</p>
<p>简要题解：首先我们考虑无标号有根树计数，令 $F(x)$ 为无标号有根树的生成函数</p>
<p>我们枚举根节点，容易得到  $F(x)=x\times Euler(F(x))=x\times exp(\sum_{n=1}\frac{F(x^n)}{n})$</p>
<p>我们考虑求 $F(x)$，容易想到使用牛顿迭代，我们令 $H(F_k(x))=F_k(x)-x\times exp(\sum_{n=1}\frac{F_k(x^n)}{n})\equiv 0(\bmod x^{2^k})$，注意到 $exp$ 里的求和 有一个 $F_k(x^n)$，因为 $F_k(x)$ 的前 $2^{k-1}$ 项一定与 $F_{k-1}(x)$ 相同，所以当 $n\ge 2$ 时，$\frac{F_k(x^n)}{n}$ 只与 $F_{k-1}(x)$ 有关，换句话说这个东西是常数，那么我们现在能够得到 $H(F_k(x))=F_k(x)-x\times exp(\sum_{n=2}\frac{F_k(x^n)}{n})\times exp F_k(x),H’(F_k(x))=1-x\times exp(\sum_{n=2}\frac{F_k(x^n)}{n})\times exp F_k(x)$，根据牛顿迭代的公式，我们能够得到 $F_k(x)=F_{k-1}(x)-\frac{F_k(x)-x\times exp(\sum_{n=2}\frac{F_k(x^n)}{n})\times exp F_k(x)}{1-x\times exp(\sum_{n=2}\frac{F_k(x^n)}{n})\times exp F_k(x)}$</p>
<p>时间复杂度为 $O(n\log n)$，常数较大</p>
<p>然后我们考虑无标号无根树计数，相对于无标号有根树计数，我们只需要在根为重心的时候统计一次即可，如果 $n$ 是奇数，那么树的重心有且仅有一个，我们枚举根的一个大于 $\lceil \frac{n}{2}\rceil$ 的子树的大小即可，不合法的答案为 $\sum_{i=\lceil\frac{n}{2}\rceil}^{n-1}f_{i}f_{n-i}$，如果 $n$ 是偶数，那么有可能存在有两个重心的情况，如果将两个重心中间的边断开，形成两棵树，这两棵树如果完全相同，则这些方案我们只会统计一次，不会算重，否则我们恰好算了两次，那么我们把多算的减掉即可，即减掉 $\binom{f_{\frac{n}{2}}}{2}$ 次</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2021/12/18/Luogu-P5900-%E6%97%A0%E6%A0%87%E5%8F%B7%E6%97%A0%E6%A0%B9%E6%A0%91%E8%AE%A1%E6%95%B0/">Luogu P5900 无标号无根树计数</a></p>
</li>
<li><p>简要题意：假设现在有一个集合 $S$，$S$ 中只含若干个 $[1,n]$ 的正整数，我们令 $f(k)$ 为把 $k$ 表示成 $S$ 中的元素的和的方案数，每个数都能用无限次，每种方案都是无序的，现在给定 $f(1)$ 到 $f(n)$ 这 $n$ 个模 $p$ 的值，求构造一个字典序最小的集合 $S$，保证 $p$ 是素数，但不一定是 $998244353$</p>
<p>$n\le 2^{18}$</p>
<p>简要题解：我们不妨令 $f(x)$ 的生成函数为 $F(x)$，根据一些经典结论容易得到 $F(x)=\prod_{a_i\in S}\frac{1}{1-x^{a_i}}=\exp(\sum_{a_i\in S}\ln\frac{1}{1-x^{a_i}})=\exp(\sum_{a_i\in S}\sum_{n=1}\frac{x^{na_i}}{n})$</p>
<p>两边取一下 $\ln$，能够得到 $\ln F(x)=\sum_{a_i\in S}\sum_{n=1}\frac{x^{na_i}}{n}$，我们令 $G(x)$ 表示 $S$ 的生成函数，含义为如果 $S$ 有 $a_i$ 这个元素，那么 $x^{a_i}$ 的系数为 $1$，否则为 $0$，那么能够得到 $f(k)=\frac{1}{k}\sum_{d|k}\frac{d}{k}g(d)$，容易发现这是一个莫比乌斯反演的形式，那么答案一定是唯一的</p>
<p>唯一的难点在于任意模数多项式求逆，用三模NTT写确实慢，时间复杂度 $O(n\log n)$</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2021/12/19/P3784-SDOI2017-%E9%81%97%E5%BF%98%E7%9A%84%E9%9B%86%E5%90%88/">P3784 [SDOI2017] 遗忘的集合</a></p>
</li>
<li><p>简要题意：现在有两个序列 $a$ 和 $b$，长度分别为 $n$ 和 $m$，现在随机从 $a$ 中选一个数 $x$，然后再随机从 $b$ 中选一个数<br>$y$，求对于 $k\in [1,t]$，$(x+y)^k$ 的期望是多少，答案对 $998244353$ 取模</p>
<p>$a,b,t\le 10^5$</p>
<p>简要题解：我们将 $(x+y)^k$ 拆开，然后得到 $ans_k=\sum_{x=1}^n\sum_{y=1}^m\sum_{i=0}^k\binom{k}{i}a_x^ib_y^{k-i}$，稍微交换一下求和顺序，$ans_k=\sum_{i=0}^n\binom{k}{i}(\sum_{i=1}^na_x^i)(\sum_{j=1}^mb_y^{k-i})$，我们令 $A_k$ 表示 $\sum_{i=1}^na_i^k$，如果我们能预处理 $A_0$ 到 $A_1$，那么 $ans$ 我们可以直接卷积</p>
<p>我们现在考虑如何求 $A_k$，我们令 $A_k$ 的生成函数为 $F(x)$，容易得到 $F(x)=\sum_{i=1}^n\frac{1}{1-a_ix}$，发现对于分数的求和并没有什么特别好的做法，一个比较简单的做法是类似于分治+NTT的做法，我们直接维护分子和分母这两个多项式，然后左右两边乘的时候暴力通分即可</p>
<p>我们接下来考虑一个比较神奇的做法，我们考虑将这个 $\sum$ 变成 $\prod$，实现这个的最好做法是 $\ln$，但原始并没有 $\ln$，所以我们造一个 $\ln$，我们知道 $\ln’(1-a_ix)=\frac{-a_i}{1-a_ix}$，我们令 $G(x)=\sum_{i=1}^n\ln’(1-a_ix)$，那么我们有 $F(x)=-xG(x)+n$</p>
<p>而 $G(x)=\sum_{i=1}^n\ln’(1-a_ix)=\ln’(\prod_{i=1}^n1-a_ix)$，这个直接分治+NTT加多项式 $\ln$ 即可</p>
<p>时间复杂度 $O(n\log^2 n)$</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2021/12/19/Luogu-P4705-%E7%8E%A9%E6%B8%B8%E6%88%8F/">Luogu P4705 玩游戏</a></p>
</li>
<li><p>简要题意：给定一个长度为 $n$ 的序列 $a_i$，现在需要计算对于所有满足条件的序列 $b_i$ $\prod_{i=1}^n\binom{b_i}{a_i}$ 的累加和，序列 $b_i$ 满足的条件为序列 $b$ 只包含自然数且长度为 $n$，序列 $b_i$ 中所有数的和小于等于 $m$</p>
<p>$n\le 5000,a_i\le 2000,m\le 10^9$</p>
<p>简要题解：考虑生成函数，我们令 $F_k(x)=\sum_{i=0}^\infty\binom{i}{a_k}x^k$，容易得到答案就是 $\sum_{k=0}^m[x^k]\prod_{i=1}^nF_i(x)$，注意到 $F_i(x)$ 的形式还可以继续化简，根据 $\frac{1}{(1-x)^k}=\sum_{i=0}^\infty\binom{i+k-1}{k-1}x^i$，我们可以得到 $F_k(x)=\frac{x^{a_k}}{(1-x)^{a_k+1}}$</p>
<p>那么 $ans=\sum_{k=0}^m[x^k]\frac{x^{\sum_{i=1}^na_i}}{(1-x)^{n+\sum_{i=1}^na_i}}$，我们令 $t=\sum_{i=1}^na_i$，那么 $ans=\binom{m+n}{n+t}$</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2022/04/01/%E6%96%87%E8%BF%9C%E7%9F%A5%E8%A1%8C%E6%9D%AF%E5%B9%BF%E4%B8%9C%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6%E7%AC%AC%E5%8D%81%E5%85%AD%E5%B1%8A%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AB%9E%E8%B5%9B-J-%E4%B8%80%E9%81%93%E8%AE%A1%E6%95%B0%E9%A2%98/">文远知行杯广东工业大学第十六届程序设计竞赛 J 一道计数题</a></p>
</li>
<li><p>简要题意：给定 $m$ 个字符串 $S_i$，字符集为 $[1,n]$，现在要求对于每个字符串 $S_i$ 进行如下操作：从空串 $T$ 开始，每次随机生成一个 $[1,n]$ 内的整数，添加到 $T$ 的末尾，直到 $S$ 作为 $T$ 的子串出现过，求 $T$ 的期望长度</p>
<p>$|S_i|,n\le 10^5,m\le 50$</p>
<p>简要题解：我们令 $f_i$ 表示 $T$ 的长度为 $i$ 的概率，$g_i$ 表示 $T$ 的长度大于 $i$ 的概率，分别令 $F(x)$ 和 $G(x)$ 为 $f_i$ 和 $g_i$ 的生成函数</p>
<p>容易得到 $F(x)+G(x)=1+xG(x)$ 这个等式，可以理解其为没有停止时，我们再加入一个字符，有停止和继续两种情况，加一是处理边界情况</p>
<p>同时，我们可以得到另一个等式 $G(x)(\frac{1}{n}x)^m=F(x)\sum_{i=1}^na_i(\frac{1}{n}x)^{m-i}$，这里我们令 $m$ 表示字符串 $S$ 的长度 $a_i$ 表示 $S[1..i]$ 是否为 $S$ 的 $border$，这个等式可能理解起来有一点难度，我们可以理解其为没有停止的串加入 $S$ 之后一定会停止，但注意到可能会在完整添加 $S$ 之前停止，这种情况只有在 $S[1..i]$ 是 $S$ 的 $border$ 的情况下，我们添加了 $S[1..i]$ 就已经停止了</p>
<p>我们考虑利用这两个式子来得到我们所需要的答案，即 $F’(1)$</p>
<p>我们对第一个式子求导并带入 $x=1$，可以得到 $F’(1)=G(1)$，在第二个式子里带入 $x=1$ 并化简可以得到 $G(1)=\sum_{i=1}^m a_in^i$，时间复杂度 $O(n)$</p>
<p><a target="_blank" rel="noopener" href="https://ddosvoid.github.io/2022/04/20/Luogu-P4548-CTSC2006-%E6%AD%8C%E5%94%B1%E7%8E%8B%E5%9B%BD/">Luogu P4548 [CTSC2006]歌唱王国</a></p>
</li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------　　　　本文结束　<i class="fa fa-flag"></i>　感谢阅读　　　　-------------</div>
    
</div>

          <div class="post-tags">
              <a href="/tags/Tech/" rel="tag"># Tech</a>
              <a href="/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" rel="tag"># 生成函数</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/07/25/CF-955C-Sad-powers/" rel="prev" title="CF 955C Sad powers">
                  <i class="fa fa-chevron-left"></i> CF 955C Sad powers
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/07/26/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A14-B-Sample-Game/" rel="next" title="2021牛客多校4 B Sample Game">
                  2021牛客多校4 B Sample Game <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
  
  
  



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 2020 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">DDOSvoid</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">1.4m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">21:34</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-use    r"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  


















  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>








  

  
      <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = '//cdn.jsdelivr.net/npm/mathjax@3.1.0/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
